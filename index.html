<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ’—</title>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>

<div class="bg_heart">
    <div class="message"></div>
    <a href="love.html" class="next-button">ÐºÐ»Ð¸Ðº:3</a>
</div>


<audio id="backgroundMusic" loop playsinline>
    <source src="assets/blue.mp3" type="audio/mpeg">
</audio>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="script/main.js"></script>


<script>
document.addEventListener("DOMContentLoaded", function () {

    const music = document.getElementById("backgroundMusic");
    const MAX_VOLUME = 0.7;

    function fadeIn(audio, duration = 3000) {
        audio.volume = 0;
        audio.play();

        let step = 0.02;
        let interval = duration / (MAX_VOLUME / step);

        let fade = setInterval(() => {
            if (audio.volume < MAX_VOLUME) {
                audio.volume = Math.min(audio.volume + step, MAX_VOLUME);
            } else {
                clearInterval(fade);
            }
        }, interval);
    }

    if (sessionStorage.getItem("musicStarted")) {
        const savedTime = sessionStorage.getItem("musicTime") || 0;
        music.currentTime = parseFloat(savedTime);
        music.volume = MAX_VOLUME;
        music.play().catch(() => {});
    } else {
        document.addEventListener("click", function startMusic() {
            music.currentTime = 23;
            fadeIn(music, 3000);
            sessionStorage.setItem("musicStarted", "true");
            document.removeEventListener("click", startMusic);
        });
    }

    setInterval(() => {
        if (!music.paused) {
            sessionStorage.setItem("musicTime", music.currentTime);
        }
    }, 1000);

});
</script>

</body>
</html>

